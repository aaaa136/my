<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>提出物サーチ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(120deg, #74ebd5 0%, #acb6e5 100%);
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: #ffffff;
      padding: 3rem;
      border-radius: 1.5rem;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
      width: 100%;
      max-width: 600px;
      animation: fadeIn 0.6s ease-in-out;
    }
    h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #2d3436;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    input, select, button {
      width: 100%;
      padding: 1rem;
      border-radius: 1rem;
      border: 1px solid #dfe6e9;
      font-size: 1rem;
      margin-bottom: 1.2rem;
    }
    button {
      background-color: #0984e3;
      color: #fff;
      font-weight: 600;
      transition: background-color 0.3s ease;
      border: none;
    }
    button:hover {
      background-color: #74b9ff;
    }
    .back-button {
      background-color: #636e72;
      margin-top: 1rem;
    }
    .result {
      margin-top: 2rem;
    }
    .task {
      background: #f1f2f6;
      border-left: 6px solid #6c5ce7;
      padding: 1.2rem;
      border-radius: 1rem;
      margin-bottom: 1.5rem;
      animation: fadeInUp 0.4s ease;
    }
    .task-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #2d3436;
    }
    .task-deadline {
      color: #d63031;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }
    .submitted::before {
      content: "✅ ";
      color: #00b894;
    }
    .not-submitted::before {
      content: "❌ ";
      color: #d63031;
    }
    a {
      color: #6c5ce7;
      text-decoration: none;
      font-weight: 500;
    }
    a:hover {
      text-decoration: underline;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #loginScreen { display: block; }
    #mainApp { display: none; }
  </style>
</head>
<body>
  <div class="container" id="loginScreen">
    <h1>ログイン</h1>
    <input type="text" id="studentId" placeholder="学籍番号" pattern="\d*" inputmode="numeric">
    <input type="text" id="studentName" placeholder="氏名">
    <button onclick="login()">ログイン</button>
  </div>

  <div class="container" id="mainApp">
    <h1>提出物サーチ</h1>
    <label for="subject">科目を選択:</label>
    <select id="subject">
      <option value="未来工学特論B">未来工学特論B</option>
      <option value="UX/UIデザイン">UX/UIデザイン</option>
      <option value="デザイン思考B">デザイン思考B</option>
      <option value="English for CommunicationA">English for CommunicationA</option>
      <option value="システム開発の基礎">システム開発の基礎</option>
      <option value="ソフトウェア工学基礎">ソフトウェア工学基礎</option>
      <option value="プロジェクトマネジメント">プロジェクトマネジメント</option>
    </select>
    <button onclick="searchTask()">確認する</button>
    <div class="result" id="result"></div>
  </div>

  <script>
    const deadlines = {
      "未来工学特論B": { day: 5, professors: ["柴崎亮介", "小塩篤史"], link: "https://rp.reitaku-u.ac.jp/uprx/up/pk/pky001/Pky00101.xhtml", type: "レポート" },
      "UX/UIデザイン": { day: 0, professors: ["笹尾知世", "河野洋"], link: "https://padlet.com/tsasao/ui-ux-design-2025-wdm3o6nojd6hlzv8", type: "最終レポート" },
      "デザイン思考B": { day: 5, professors: ["笹尾知世", "柴崎亮介"], link: "https://padlet.com/tsasao/ui-ux-design-2025-wdm3o6nojd6hlzv8", type: "レポート" },
      "English for CommunicationA": { day: 3, professors: [], link: "https://classroom.google.com/", type: "Homework" },
      "システム開発の基礎": { day: 1, professors: ["宗健", "塚田義典"], link: "https://rp.reitaku-u.ac.jp/uprx/up/pk/pky001/Pky00101.xhtml", type: "Access課題" },
      "ソフトウェア工学基礎": { day: 0, professors: ["塚田義典", "清田陽司"], link: "https://rp.reitaku-u.ac.jp/uprx/up/pk/pky001/Pky00101.xhtml", type: "小テスト" },
      "プロジェクトマネジメント": { day: 5, professors: ["宗健", "新井亜弓"], link: "https://rp.reitaku-u.ac.jp/uprx/up/pk/pky001/Pky00101.xhtml", type: "課題" }
    };

    function login() {
      const id = document.getElementById("studentId").value.trim();
      const name = document.getElementById("studentName").value.trim();
      if (id && name) {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("mainApp").style.display = "block";
      } else {
        alert("学籍番号と氏名を入力してください。");
      }
    }

    function getDeadlineDate(baseDate, weekOffset, targetDay) {
      const date = new Date(baseDate);
      date.setDate(date.getDate() + 7 * weekOffset);
      const dayDiff = (targetDay + 7 - date.getDay()) % 7;
      date.setDate(date.getDate() + dayDiff);
      return new Date(date.setHours(23, 59, 0, 0));
    }

    function formatDate(date) {
      return `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()}`;
    }

    function searchTask() {
      const subject = document.getElementById("subject").value;
      const resultDiv = document.getElementById("result");
      const baseDate = new Date("2025-05-30T00:00:00");
      const today = new Date();
      const task = deadlines[subject];

      if (task) {
        let html = "";
        for (let i = 0; i < 8; i++) {
          const taskNumber = 7 + i;
          const deadline = getDeadlineDate(baseDate, i, task.day);
          html += `<div class="task">
            <div class="task-title">${task.type} ${taskNumber}</div>
            <div class="task-deadline">締切: ${formatDate(deadline)} 23:59</div>
            <div class="task-status">`;

          if (i === 0) {
            const submitted = Math.random() > 0.5;
            const statusClass = submitted ? "submitted" : "not-submitted";
            const statusText = submitted ? "提出済" : "未提出";
            html += `<span class="${statusClass}">ステータス: ${statusText}</span><br>`;
            html += `<a href="${task.link}" target="_blank">課題の詳細はこちら</a>`;
          } else if (today >= new Date(deadline.getTime() - 7 * 24 * 60 * 60 * 1000)) {
            html += `<a href="${task.link}" target="_blank">課題の詳細はこちら</a>`;
          } else {
            html += "公開前";
          }

          html += `</div><div style="margin-top:8px;">課題作成者: ${task.professors.join("・") || "表示なし"}</div></div>`;
        }
        resultDiv.innerHTML = html + '<button class="back-button" onclick="goBack()">戻る</button>';
      } else {
        resultDiv.innerHTML = "<p>情報が見つかりませんでした。</p>";
      }
    }

    function goBack() {
      document.getElementById("result").innerHTML = "";
    }

    // 学籍番号を数字のみに制限
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("studentId").addEventListener("input", function(e) {
        this.value = this.value.replace(/\D/g, "");
      });
    });
  </script>
</body>
</html>
